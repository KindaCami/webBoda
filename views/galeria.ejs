<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gracias · Boda Víctor & Camilo</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;1,300;1,400&family=Orbitron:wght@300;400;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --gold: #c9a96e;
            --white: #f5f0e8;
            --bg: #050405;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background: var(--bg);
            color: var(--white);
            font-family: 'Cormorant Garamond', serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .film-grain {
            position: fixed; inset: 0; z-index: 10; pointer-events: none;
            opacity: 0.04;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
        }

        .vignette {
            position: fixed; inset: 0; z-index: 5; pointer-events: none;
            background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.8) 100%);
        }

        .nebula {
            position: fixed; inset: 0; z-index: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(201,169,110,0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0,136,255,0.03) 0%, transparent 50%);
            filter: blur(60px);
            animation: nebulaPulse 10s infinite alternate;
        }

        @keyframes nebulaPulse {
            from { transform: scale(1); opacity: 0.5; }
            to { transform: scale(1.2); opacity: 0.8; }
        }

        .content-center {
            position: relative;
            z-index: 20;
            text-align: center;
            max-width: 600px;
            padding: 40px;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(201,169,110,0.1);
            border-radius: 2px;
        }

        .title-mini {
            font-family: 'Orbitron'; font-size: 0.5rem; letter-spacing: 0.5em;
            color: var(--gold); text-transform: uppercase; margin-bottom: 20px;
        }

        .h-thanks {
            font-size: clamp(2rem, 5vw, 3.5rem);
            font-style: italic; font-weight: 300;
            line-height: 1.1; margin-bottom: 25px;
        }

        .h-thanks em { color: var(--gold); font-style: normal; }

        .line-gold {
            width: 40px; height: 1px; background: var(--gold);
            margin: 0 auto 25px; opacity: 0.5;
        }

        .photo-orbit {
            position: fixed;
            z-index: 1;
            transition: transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            filter: grayscale(0.5) contrast(1.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
            border: 1px solid rgba(255,255,255,0.05);
            pointer-events: auto;
        }

        .photo-orbit:hover {
            filter: grayscale(0) contrast(1);
            transform: scale(1.2) !important;
            z-index: 30;
            border-color: var(--gold);
        }

        .photo-orbit img { width: 100%; height: 100%; object-fit: cover; }

        .exit-timer {
            position: fixed; bottom: 40px; left: 50%; transform: translateX(-50%);
            z-index: 20; text-align: center;
        }

        .timer-bar-container {
            width: 200px; height: 2px; background: rgba(255,255,255,0.1);
            margin-top: 10px; border-radius: 2px; overflow: hidden;
        }

        .timer-bar-fill {
            width: 100%; height: 100%; background: var(--gold);
            transform-origin: left;
            animation: countdown 60s linear forwards;
        }

        @keyframes countdown {
            from { transform: scaleX(1); }
            to { transform: scaleX(0); }
        }

        .timer-text {
            font-family: 'Orbitron'; font-size: 0.5rem; letter-spacing: 0.2em;
            color: rgba(255,255,255,0.3); text-transform: uppercase;
        }
    </style>
</head>
<body>

<div class="nebula"></div>
<div class="vignette"></div>
<div class="film-grain"></div>

<div class="content-center">
    <div class="title-mini">Sesión Finalizada</div>
    <h1 class="h-thanks">Gracias por formar parte de nuestra <em>historia</em></h1>
    <div class="line-gold"></div>
    <p style="font-style: italic; color: rgba(245,240,232,0.4); font-size: 0.9rem;">
        Nos vemos muy pronto para celebrar la vida juntos.
    </p>
</div>

<% for(let i = 1; i <= 15; i++) { %>
    <div class="photo-orbit" id="p-<%= i %>">
        <img src="/images/galeria/img<%= String(i).padStart(2,'0') %>.jpg" alt="Recuerdo <%= i %>">
    </div>
<% } %>

<div class="exit-timer">
    <div class="timer-text">Desconectando en <span id="seconds">60</span>s</div>
    <div class="timer-bar-container">
        <div class="timer-bar-fill"></div>
    </div>
</div>

<audio id="audio-semaphore" src="/audio/semaphore.mp3" loop></audio>

<script>
    const audio = document.getElementById('audio-semaphore');
    let timeLeft = 60;

    function playSemaphore() {
        audio.volume = 0;
        audio.play().then(() => {
            let vol = 0;
            const fadeIn = setInterval(() => {
                vol += 0.02;
                audio.volume = Math.min(vol, 0.4);
                if (vol >= 0.4) clearInterval(fadeIn);
            }, 150);
        }).catch(() => {});
    }

    window.addEventListener('load', playSemaphore);
    document.addEventListener('click', () => { if(audio.paused) playSemaphore(); }, {once: true});

    const countdown = setInterval(() => {
        timeLeft--;
        document.getElementById('seconds').innerText = timeLeft;
        if (timeLeft <= 0) {
            clearInterval(countdown);
            window.location.href = "/";
        }
    }, 1000);

    // LISTADO AMPLIADO A 15 POSICIONES
    const photos = document.querySelectorAll('.photo-orbit');
    const positions = [
        { w: 140, h: 100, x: 8,  y: 12 }, { w: 100, h: 140, x: 82, y: 8 },
        { w: 120, h: 120, x: 12, y: 72 }, { w: 150, h: 100, x: 78, y: 78 },
        { w: 90, h: 130,  x: 4,  y: 42 }, { w: 110, h: 110, x: 88, y: 45 },
        { w: 130, h: 90,  x: 42, y: 4 },  { w: 100, h: 100, x: 48, y: 88 },
        { w: 120, h: 160, x: 26, y: 8 },  { w: 140, h: 100, x: 62, y: 12 },
        { w: 80,  h: 120, x: 22, y: 82 }, { w: 100, h: 140, x: 72, y: 84 },
        // Nuevas posiciones para las fotos 13, 14 y 15
        { w: 115, h: 145, x: 90, y: 22 }, { w: 135, h: 105, x: 2,  y: 65 },
        { w: 125, h: 125, x: 55, y: 82 }
    ];

    photos.forEach((photo, i) => {
        const pos = positions[i];
        if(!pos) return; // Seguridad por si acaso
        
        photo.style.width = pos.w + 'px';
        photo.style.height = pos.h + 'px';
        photo.style.left = pos.x + '%';
        photo.style.top = pos.y + '%';
        
        let angle = Math.random() * Math.PI * 2;
        setInterval(() => {
            angle += 0.008; // Un poco más lento para que sea más elegante
            const ox = Math.cos(angle) * 12;
            const oy = Math.sin(angle) * 12;
            photo.style.transform = `translate(${ox}px, ${oy}px)`;
        }, 30);
    });
</script>

</body>
</html>
